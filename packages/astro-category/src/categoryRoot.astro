---
import { getCollection } from 'astro:content';
import CategoryItem from './categoryItem.astro';

interface Props {
  dir?: string;
  linkStyle?: string;
}

const { dir = 'posts', linkStyle } = Astro.props;

const allPosts = await getCollection(dir);

const category = [
  ...new Set(
    allPosts
      .filter((post: any) => post.id.split('/').length > 1)
      .map((post: any) => post.slug.split('/')[0])
  )
];
const content = [
  ...new Set(
    allPosts
      .filter((post: any) => post.id.split('/').length === 1)
      .map((post: any) => post)
  )
];
---

<h1>Root</h1>
<h2>SubContent</h2>
{
  content.map((cate: any) => (
    <CategoryItem
      url={`/${dir}/${cate.slug}/`}
      title={cate.data.title}
      style={linkStyle}
    />
  ))
}
<h2>SubCategory</h2>
{
  category.map((cate: any) => (
    <CategoryItem
      title={cate}
      url={`/category/${cate}`}
      style={linkStyle}
    />
  ))
}
